(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[815],{3898:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/[slug]",function(){return n(1929)}])},9724:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var s=n(5893),c=n(1664),i=n.n(c),l=n(7294),r=n(2373);function o(e){let{username:t}=(0,l.useContext)(r.S);return t?e.children:e.fallback||(0,s.jsx)(i(),{href:"/enter",children:"You must sign in"})}},9270:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var s=n(5893);function c(e){let{show:t}=e;return t?(0,s.jsx)("div",{className:"loader"}):null}},1929:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var s=n(5893),c=n(7809),i=n.n(c),l=n(8233),r=n(9724),o=n(7294),a=n(9270);function u(){let[e,t]=(0,o.useState)(!1),[n,c]=(0,o.useState)(0),[i,r]=(0,o.useState)(null),u=async e=>{let n=Array.from(e.target.files)[0],s=n.type.split("/")[1],i=l.tO.ref("uploads/".concat(l.I8.currentUser.uid,"/").concat(Date.now(),".").concat(s));t(!0);let o=i.put(n);o.on(l.mC,e=>{let n=(e.bytesTransferred/e.totalBytes*100).toFixed(0);c(n),o.then(e=>i.getDownloadURL()).then(e=>{r(e),t(!1)})})};return(0,s.jsxs)("div",{className:"box",children:[(0,s.jsx)(a.Z,{show:e}),e&&(0,s.jsxs)("h3",{children:[n,"%"]}),!e&&(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("label",{className:"btn",children:["\uD83D\uDCF8 Upload IMG",(0,s.jsx)("input",{type:"file",onChange:u,accept:"image/x-png,image/gif,image/jpeg"})]})}),i&&(0,s.jsx)("code",{className:"upload-snippet",children:"![alt](".concat(i,")")})]})}var d=n(1163),h=n(6552),x=n(4740),f=n(7536),m=n(1664),j=n.n(m),p=n(6501);function b(e){let{}=e;return(0,s.jsx)(r.Z,{children:(0,s.jsx)(_,{})})}function _(){let[e,t]=(0,o.useState)(!1),n=(0,d.useRouter)(),{slug:c}=n.query,r=l.RZ.collection("users").doc(l.I8.currentUser.uid).collection("posts").doc(c),[a]=(0,h.Xi)(r);return(0,s.jsx)("main",{className:i().container,children:a&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("section",{children:[(0,s.jsx)("h1",{children:a.title}),(0,s.jsxs)("p",{children:["ID: ",a.slug]}),(0,s.jsx)(g,{postRef:r,defaultValues:a,preview:e})]}),(0,s.jsxs)("aside",{children:[(0,s.jsx)("h3",{className:"full-width",children:"Tools"}),(0,s.jsx)("button",{className:"full-width",onClick:()=>t(!e),children:e?"Edit":"Preview"}),(0,s.jsx)(j(),{href:"/".concat(a.username,"/").concat(a.slug),children:(0,s.jsx)("button",{className:"btn-blue full-width",children:"Live view"})}),(0,s.jsx)(w,{postRef:r})]})]})})}function g(e){let{defaultValues:t,postRef:n,preview:c}=e,{register:r,handleSubmit:o,reset:a,watch:d,formState:h,errors:m}=(0,f.cI)({defaultValues:t,mode:"onChange"}),{isValid:j,isDirty:b}=h,_=async e=>{let{content:t,published:s}=e;await n.update({content:t,published:s,updatedAt:(0,l.Bt)()}),a({content:t,published:s}),p.ZP.success("Job Post Updated Successfully!")};return(0,s.jsxs)("form",{onSubmit:o(_),children:[c&&(0,s.jsx)("div",{className:"card",children:(0,s.jsx)(x.D,{children:d("content")})}),(0,s.jsxs)("div",{className:c?i().hidden:i().controls,children:[(0,s.jsx)(u,{}),(0,s.jsx)("textarea",{name:"content",...r("content",{minLength:{value:10,message:"content is too short"},required:{value:!0,message:"content is required"}})}),(null==m?void 0:m.content)&&(0,s.jsx)("p",{className:"text-danger",children:m.content.message}),(0,s.jsxs)("fieldset",{children:[(0,s.jsx)("input",{className:i().checkbox,type:"checkbox",...r("published",{required:!0})}),(0,s.jsx)("label",{children:"Published"})]}),(0,s.jsx)("button",{type:"submit",className:"btn-green",disabled:!b||!j,children:"Update Job Post"})]})]})}function w(e){let{postRef:t}=e,n=(0,d.useRouter)(),c=async()=>{let e=confirm("Sure you want to delete this job post?");e&&(await t.delete(),n.push("/admin"),(0,p.ZP)("Job Post Deleted! ",{icon:"\uD83D\uDDD1Ô∏è"}))};return(0,s.jsx)("button",{className:"btn-red full-width",onClick:c,children:"Delete"})}},7809:function(e){e.exports={container:"Admin_container__7Kd1y",hidden:"Admin_hidden__blWKt",controls:"Admin_controls__RhTAv",input:"Admin_input__9_7r7",checkbox:"Admin_checkbox__Ttf_p"}}},function(e){e.O(0,[460,998,774,888,179],function(){return e(e.s=3898)}),_N_E=e.O()}]);